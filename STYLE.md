# 코딩 스타일 가이드

## 파일 관리
- 터미널에서 `python -c` 등을 통해 직접 실행한다.
- **불필요한 파일 생성 금지**: 프로젝트 구조를 깔끔하게 유지하기 위해 불필요한 파일 생성을 자제한다.

## 라이브러리 및 SDK
- **Google GenAI SDK**: `google.generativeai` (Deprecated) 대신 최신 `google.genai` 라이브러리를 사용한다.
- **모델**: `gemini-2.0-flash`를 기본 모델로 사용한다.

## CLI 출력 스타일
- **초기화**: `main()` 함수 시작 시 `os.system("clear")`를 호출하여 콘솔 화면을 초기화한다.
- **입력 프롬프트**: `input("호두 > ")` 형식으로 사용자 이름을 표시한다.
- **AI 응답**: `print(f"AI: {response}")` 형식으로 AI 접두사를 붙여 출력한다.

## 로깅
- **log.md**: 프로그램 실행 시 `log.md` 파일을 새로 생성("w" 모드)하여 대화 내용을 기록한다.
- **기록 형식**: 각 메시지마다 역할(User/Gemini/Tool->Gemini/Error)과 타임스탬프를 Markdown 형식으로 기록한다.
    - **Tool->Gemini**: 도구 실행 결과는 `Tool->Gemini` 역할로 명시하여 로그에 기록한다.
- **기록 대상**: LLM 모델과의 데이터 교환만 기록한다.

## 도구(Function Calling)
- **개별 파일 구조**: 각 도구는 `tools/` 폴더 내 개별 `.py` 파일로 구현한다. `__init__.py`는 사용하지 않는다.
- **파일 규약**: 각 도구 파일은 `SCHEMA` (FunctionDeclaration)와 `main()` 함수를 정의한다.
- **직접 실행**: 인자 없이 실행하면 스키마를 JSON으로 출력, 인자가 있으면 `main()`을 실행한다.
- **동적 로드**: `list_files.py`를 `subprocess`로 실행하여 파일 목록을 조회한 뒤, `importlib`로 각 파일을 동적 로드한다.
- **스키마 분리**: 도구의 설명(JSON Schema)만 모델에 전달하고, 파이썬 코드는 노출하지 않는다.
- **자동 호출 비활성화**: `automatic_function_calling`을 비활성화하고 도구 호출/결과 전달을 수동으로 처리한다.
- **연쇄 호출 지원**: 모델이 여러 도구를 순차적으로 호출할 수 있도록 `while` 루프로 반복 처리한다.
- **파일 저장 도구**:
    - **디렉토리 자동 생성**: 파일 저장 시 상위 디렉토리가 없으면 자동으로 생성한다 (`os.makedirs`).
    - **덮어쓰기 방지**: `overwrite` 파라미터(기본값 False)를 두어, 기존 파일이 존재할 경우 에러 메시지로 사용자 확인을 유도한다.
- **보안**: `list_files` 등 파일 시스템 접근 도구는 현재 디렉토리 하위 경로로만 제한한다.

## 코드 구조
- **간결함 우선**: 별도 함수로 분리하지 않고 메인 루프에 직접 작성하여 코드를 짧게 유지한다.